# Sigmoid

## 0x00 说明

RoPE基础版本，包含了RoPE在Llama的最小实现。

包含以下内容：

- [X] rope_f32_kernel
- [X] rope_f32x4_kernel(float4向量化版本)
- [X] PyTorch bindings


## 测试

```bash
# 只测试Ada架构 不指定默认编译所有架构 耗时较长: Volta, Ampere, Ada, Hopper, ...
export TORCH_CUDA_ARCH_LIST=Ada 
python3 rope.py
```

输出:

```bash
----------------------------------------------------------------------------------------------------
                                        M=4096, N=512
----------------------------------------------------------------------------------------------------
             out_f32: ['0.64613944  ', '-0.20645256 ', '0.65744591  '], time:0.023437ms
      out_f32x4_pack: ['0.64613944  ', '-0.20645256 ', '0.65744591  '], time:0.022471ms
          out_f32_th: ['0.64613944  ', '-0.20645256 ', '0.65744591  '], time:0.820291ms
----------------------------------------------------------------------------------------------------
                                        M=4096, N=1024
----------------------------------------------------------------------------------------------------
             out_f32: ['0.4853341   ', '0.64638734  ', '-1.03646541 '], time:0.043035ms
      out_f32x4_pack: ['0.4853341   ', '0.64638734  ', '-1.03646541 '], time:0.042570ms
          out_f32_th: ['0.4853341   ', '0.64638734  ', '-1.03646541 '], time:1.259255ms
----------------------------------------------------------------------------------------------------
                                        M=8192, N=512
----------------------------------------------------------------------------------------------------
             out_f32: ['1.32995319  ', '1.64192307  ', '0.80910504  '], time:0.043070ms
      out_f32x4_pack: ['1.32995319  ', '1.64192307  ', '0.80910504  '], time:0.042331ms
          out_f32_th: ['1.32995319  ', '1.64192307  ', '0.80910504  '], time:1.207829ms
----------------------------------------------------------------------------------------------------
                                        M=8192, N=1024
----------------------------------------------------------------------------------------------------
             out_f32: ['2.19355392  ', '-0.69717944 ', '-0.64721739 '], time:0.082839ms
      out_f32x4_pack: ['2.19355392  ', '-0.69717944 ', '-0.64721739 '], time:0.082183ms
          out_f32_th: ['2.19355392  ', '-0.69717944 ', '-0.64721739 '], time:2.027059ms
----------------------------------------------------------------------------------------------------
```
