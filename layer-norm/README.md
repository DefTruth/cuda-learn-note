# LayerNorm

## 0x00 说明

包含以下内容：

- [X] layer_norm_f32_kernel 
- [X] layer_norm_f32x4_kernel
- [X] layer_norm_f16_f16_kernel
- [X] layer_norm_f16x2_f16_kernel
- [X] layer_norm_f16x8_f16_kernel
- [X] layer_norm_f16_f32_kernel
- [X] PyTorch bindings

## 测试

```bash
# 只测试Ada架构 不指定默认编译所有架构 耗时较长
export TORCH_CUDA_ARCH_LIST=Ada 
python3 layer_norm.py
```

输出:

```bash
--------------------------------------------------------------------------------
     out_f32: [0.54253572, -0.13322251, 1.65217566], time:0.01894307ms
   out_f32x4: [0.54253572, -0.13322251, 1.65217566], time:0.00595951ms
  out_f32_th: [0.54200566, -0.13309236, 1.65056157], time:0.07212615ms
--------------------------------------------------------------------------------
  out_f16f16: [0.54248047, -0.13330078, 1.65332031], time:0.01863098ms
out_f16x2f16: [0.54248047, -0.13330078, 1.65332031], time:0.00949597ms
out_f16x8f16: [0.54248047, -0.13317871, 1.65234375], time:0.00466394ms
  out_f16f32: [0.54248047, -0.13317871, 1.65234375], time:0.01892662ms
  out_f16_th: [0.54199219, -0.13305664, 1.65039062], time:0.07164359ms
--------------------------------------------------------------------------------
```
