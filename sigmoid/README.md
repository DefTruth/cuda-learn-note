# Sigmoid

## 0x00 说明

包含以下内容：

- [X] sigmoid_f32_kernel
- [X] sigmoid_f32x4_kernel(float4向量化版本)
- [X] sigmoid_f16_kernel
- [X] sigmoid_f16x2_kernel(half2向量化)
- [X] sigmoid_f16x8_kernel(unpack版本)
- [X] sigmoid_f16x8_pack_kernel(pack版本)
- [X] PyTorch bindings


## 测试

```bash
# 只测试Ada架构 不指定默认编译所有架构 耗时较长: Volta, Ampere, Ada, Hopper, ...
export TORCH_CUDA_ARCH_LIST=Ada 
python3 sigmoid.py
```

输出:

```bash
-------------------------------------------------------------------------------------
                                        S=1024, K=1024
           out_f32: [0.44087243, 0.14466271], time:0.02537942ms
         out_f32x4: [0.44087243, 0.14466271], time:0.02537990ms
        out_f32_th: [0.44087243, 0.14466269], time:0.02580595ms
-------------------------------------------------------------------------------------
           out_f16: [0.44067383, 0.14465332], time:0.01740527ms
         out_f16x2: [0.44067383, 0.14465332], time:0.01253915ms
         out_f16x8: [0.44067383, 0.14465332], time:0.00944948ms
     out_f16x8pack: [0.44067383, 0.14465332], time:0.01032066ms
        out_f16_th: [0.44091797, 0.14465332], time:0.01068568ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=1024, K=2048
           out_f32: [0.70031989, 0.25698298], time:0.04682326ms
         out_f32x4: [0.70031989, 0.25698298], time:0.04522538ms
        out_f32_th: [0.70031983, 0.25698295], time:0.04591346ms
-------------------------------------------------------------------------------------
           out_f16: [0.70019531, 0.25708008], time:0.02805734ms
         out_f16x2: [0.70019531, 0.25708008], time:0.04277468ms
         out_f16x8: [0.70019531, 0.25708008], time:0.04243112ms
     out_f16x8pack: [0.70019531, 0.25708008], time:0.02483559ms
        out_f16_th: [0.70019531, 0.25708008], time:0.02555609ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=1024, K=4096
           out_f32: [0.72382098, 0.70522863], time:0.08829594ms
         out_f32x4: [0.72382098, 0.70522863], time:0.08938313ms
        out_f32_th: [0.72382092, 0.70522857], time:0.08877420ms
-------------------------------------------------------------------------------------
           out_f16: [0.72363281, 0.70507812], time:0.05327320ms
         out_f16x2: [0.72363281, 0.70507812], time:0.04592729ms
         out_f16x8: [0.72363281, 0.70507812], time:0.05294323ms
     out_f16x8pack: [0.72363281, 0.70507812], time:0.04625130ms
        out_f16_th: [0.72363281, 0.70507812], time:0.04694128ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=1024
           out_f32: [0.15129256, 0.30213553], time:0.04680657ms
         out_f32x4: [0.15129256, 0.30213553], time:0.04546046ms
        out_f32_th: [0.15129256, 0.30213553], time:0.04538488ms
-------------------------------------------------------------------------------------
           out_f16: [0.15124512, 0.30224609], time:0.05266333ms
         out_f16x2: [0.15124512, 0.30224609], time:0.03242540ms
         out_f16x8: [0.15124512, 0.30224609], time:0.02410793ms
     out_f16x8pack: [0.15124512, 0.30224609], time:0.02594733ms
        out_f16_th: [0.15124512, 0.30224609], time:0.02541113ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=2048
           out_f32: [0.08603064, 0.11839668], time:0.08810043ms
         out_f32x4: [0.08603064, 0.11839668], time:0.08929014ms
        out_f32_th: [0.08603063, 0.11839666], time:0.08870721ms
-------------------------------------------------------------------------------------
           out_f16: [0.08599854, 0.1184082], time:0.04961324ms
         out_f16x2: [0.08599854, 0.1184082], time:0.04895544ms
         out_f16x8: [0.08599854, 0.1184082], time:0.04524159ms
     out_f16x8pack: [0.08599854, 0.1184082], time:0.04582047ms
        out_f16_th: [0.08599854, 0.1184082], time:0.04741693ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=4096
           out_f32: [0.18312789, 0.75082397], time:0.17336440ms
         out_f32x4: [0.18312789, 0.75082397], time:0.17291713ms
        out_f32_th: [0.18312787, 0.75082397], time:0.17230439ms
-------------------------------------------------------------------------------------
           out_f16: [0.18310547, 0.75097656], time:0.09805584ms
         out_f16x2: [0.18310547, 0.75097656], time:0.09110355ms
         out_f16x8: [0.18310547, 0.75097656], time:0.08805799ms
     out_f16x8pack: [0.18310547, 0.75097656], time:0.08871484ms
        out_f16_th: [0.18310547, 0.75097656], time:0.08954501ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=1024
           out_f32: [0.29106072, 0.6601972], time:0.08967185ms
         out_f32x4: [0.29106072, 0.6601972], time:0.08809733ms
        out_f32_th: [0.29106072, 0.6601972], time:0.08927059ms
-------------------------------------------------------------------------------------
           out_f16: [0.29101562, 0.66015625], time:0.07013607ms
         out_f16x2: [0.29101562, 0.66015625], time:0.04577374ms
         out_f16x8: [0.29101562, 0.66015625], time:0.04573870ms
     out_f16x8pack: [0.29101562, 0.66015625], time:0.04517269ms
        out_f16_th: [0.29101562, 0.66015625], time:0.04767728ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=2048
           out_f32: [0.56653124, 0.57163072], time:0.17215800ms
         out_f32x4: [0.56653124, 0.57163072], time:0.17195392ms
        out_f32_th: [0.56653124, 0.57163072], time:0.17258000ms
-------------------------------------------------------------------------------------
           out_f16: [0.56640625, 0.57128906], time:0.09819770ms
         out_f16x2: [0.56640625, 0.57128906], time:0.09410906ms
         out_f16x8: [0.56640625, 0.57128906], time:0.08829379ms
     out_f16x8pack: [0.56640625, 0.57128906], time:0.08804417ms
        out_f16_th: [0.56640625, 0.57177734], time:0.08891988ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=4096
           out_f32: [0.40711096, 0.74969018], time:0.34093595ms
         out_f32x4: [0.40711096, 0.74969018], time:0.34108973ms
        out_f32_th: [0.40711093, 0.74969012], time:0.34152007ms
-------------------------------------------------------------------------------------
           out_f16: [0.40698242, 0.74951172], time:0.19360518ms
         out_f16x2: [0.40698242, 0.74951172], time:0.17145801ms
         out_f16x8: [0.40698242, 0.74951172], time:0.17265034ms
     out_f16x8pack: [0.40698242, 0.74951172], time:0.17311215ms
        out_f16_th: [0.40698242, 0.74951172], time:0.17373109ms
-------------------------------------------------------------------------------------
```
