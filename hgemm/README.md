# HGEMM 

## 0x00 说明

包含以下内容：

- [X] hgemm_sliced_k_f16_kernel 
- [X] hgemm_t_8x8_sliced_k_f16x4_kernel(unpack)
- [X] hgemm_t_8x8_sliced_k_f16x4_pack_kernel(pack 16x4)
- [X] hgemm_t_8x8_sliced_k_f16x4_bcf_kernel(bank conflicts reduce)
- [X] hgemm_t_8x8_sliced_k_f16x4_pack_bcf_kernel(bank conflicts reduce, pack)
- [X] hgemm_t_4x4_sliced_k_f16x4_pack_bcf_kernel(bank conflicts reduce, pack)
- [X] hgemm_t_8x8_sliced_k_f16x8_pack_bcf_kernel(bank conflicts reduce, pack)
- [X] hgemm_t_8x8_sliced_k_f16x8_pack_bcf_dbuf_kernel(bank conflicts reduce, pack, double buffers)
- [X] PyTorch bindings

## 共享内存 Bank Conflicts

含义：在访问shared memory时，因多个线程读写同一个Bank中的不同数据地址时，导致shared memory 并发读写 退化 成顺序读写的现象叫做Bank Conflict；

![](https://github.com/PaddleJitLab/CUDATutorial/blob/develop/docs/09_optimize_reduce/02_bank_conflict/images/ef322be7c3e5b6b9be69d2b90e88083f50569a58a97129f348e483b946ab4edf.png)

SM调度单位为一个warp（一个warp内32个Thread），shared_memory 可以 被一个warp中的所有（32个）线程进行访问，shared_memory 映射到大小相等的32个Bank上，Bank的数据读取带宽为32bit / cycle (4 bytes)，因此，主要需要考虑一个Warp内32线程的访问共享内存时的bank冲突。
对于多个线程读取同一个Bank数据时（不同地址），硬件把内存读写请求，拆分成 conflict-free requests，进行顺序读写，此时将会触发多次内存事务。特别地，当一个warp中的所有线程读写同一个地址时，会触发broadcast机制，此时不会退化成顺序读写。上面提到触发broadcast机制的条件是all threads acess same address，但在翻阅cuda-c-programming-guide以及最新版本的[NVProfGuide](https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html) 时，发现只要是多个thread 读写就会触发broadcast（不需要All）。
  
- 多个线程读同一个数据时，仅有一个线程读，然后broadcast到其他线程
- 多个线程写同一个数据时，仅会有一个线程写成功

NVIDIA的[文章](https://developer.nvidia.com/blog/using-shared-memory-cuda-cc/)中指出，我们还可以通过 `cudaDeviceSetSharedMemConfig()` 函数设置默认Bank Size（默认为4 bytes）来避免bank conflicts，可设置为cudaSharedMemBankSizeFourByte或者cudaSharedMemBankSizeEightByte。对于某些场景来说，设置cudaSharedMemBankSizeEightByte或许更加合适，比如使用double数据类型时。 

```C
cudaDeviceSetSharedMemConfig(cudaSharedMemBankSizeEightByte);
```

## 双缓冲 Double Buffers

本仓库实现的HGEMM Double Buffers策略如下：1）主循环从bk = 1 开始，第一次数据加载在主循环之前，最后一次计算在主循环之后，这是pipeline 的特点决定的；2）由于计算和下一次访存使用的Shared Memory不同，因此主循环中每次循环只需要一次__syncthreads()即可，对比非double buffers版本，总共节省了 ((K + BK - 1) / BK) - 1 次block内的同步操作。比如，bk=1时，HFMA计算使用的是s_a[0]和s_b[0]，因此，和s_a[1]和s_b[1]的加载是没有依赖关系的。HFMA计算，从global内存到s_a[1]和s_b[1]和HFMA计算可以并行。s_a[1]和s_b[1]用于加载下一块BK需要的数据到共享内存；3）由于GPU不能向CPU那样支持乱序执行，主循环中需要先将下一次循环计算需要的Gloabal Memory中的数据load 到寄存器，然后进行本次计算，之后再将load到寄存器中的数据写到Shared Memory，这样在LDG指令向Global Memory做load时，不会影响后续HFMA及其它运算指令的 launch 执行，也就达到了Double Buffers的目的。

```C
  // bk = 0 is loading here, buffer 0
  {
    int load_a_gmem_k = load_a_smem_k;
    int load_a_gmem_addr = load_a_gmem_m * K + load_a_gmem_k;
    int load_b_gmem_k = load_b_smem_k;
    int load_b_gmem_addr = load_b_gmem_k * N + load_b_gmem_n;
    LDST64BITS(r_load_a[0]) = LDST64BITS(a[load_a_gmem_addr]);
    LDST64BITS(r_load_b[0]) = LDST64BITS(b[load_b_gmem_addr]);

    s_a[0][load_a_smem_k + 0][load_a_smem_m] = r_load_a[0];
    s_a[0][load_a_smem_k + 1][load_a_smem_m] = r_load_a[1];
    s_a[0][load_a_smem_k + 2][load_a_smem_m] = r_load_a[2];
    s_a[0][load_a_smem_k + 3][load_a_smem_m] = r_load_a[3];
    LDST64BITS(s_b[0][load_b_smem_k][load_b_smem_n]) = LDST64BITS(r_load_b[0]);
  }
  // Without this synchronization, accuracy may occasionally be abnormal.
  __syncthreads(); 
  
  // bk start from 1，需要注意的是，虽然 bk 从 1 开始，但实际上 bk=1时，使用的是
  // 第0块BK中的数据（已经加载到共享内存s_a[0]和s_b[0]）；bk=2时，实际计算的是第1块
  // BK中的数据。其余以此类推，这个循环结束后，剩下最后一块BK大小的数据需要计算。
  for (int bk = 1; bk < (K + BK - 1) / BK; bk++) {

    int smem_sel = (bk - 1) & 1; // bk 1->0, bk 2->1, bk 3->0, ...
    int smem_sel_next = bk & 1;  // bk 1->1, bk 2->0, bk 3->1, ...

    int load_a_gmem_k = bk * BK + load_a_smem_k;
    int load_a_gmem_addr = load_a_gmem_m * K + load_a_gmem_k;
    int load_b_gmem_k = bk * BK + load_b_smem_k;
    int load_b_gmem_addr = load_b_gmem_k * N + load_b_gmem_n;
    LDST64BITS(r_load_a[0]) = LDST64BITS(a[load_a_gmem_addr]);
    LDST64BITS(r_load_b[0]) = LDST64BITS(b[load_b_gmem_addr]);
    
    #pragma unroll
    for (int tk = 0; tk < BK; tk++) {
      LDST128BITS(r_comp_a[0]) = LDST128BITS(s_a[smem_sel][tk][ty * TM]);
      LDST128BITS(r_comp_b[0]) = LDST128BITS(s_b[smem_sel][tk][tx * TN]);

      #pragma unroll
      for (int tm = 0; tm < TM; tm++) {
        #pragma unroll
        for (int tn = 0; tn < TN; tn++) {
          r_c[tm][tn] = __hfma(r_comp_a[tm], r_comp_b[tn], r_c[tm][tn]);
        }
      }
    }

    // 对比非double buffers版本，此处不需要__syncthreads()，总共节省了
    // ((K + BK - 1) / BK) - 1 次block内的同步操作。比如，bk=1时，HFMA计算
    // 使用的是s_a[0]和s_b[0]，因此，和s_a[1]和s_b[1]的加载是没有依赖关系的。
    // 从global内存到s_a[1]和s_b[1]和HFMA计算可以并行。s_a[1]和s_b[1]用于
    // 加载下一块BK需要的数据到共享内存。
    s_a[smem_sel_next][load_a_smem_k + 0][load_a_smem_m] = r_load_a[0];
    s_a[smem_sel_next][load_a_smem_k + 1][load_a_smem_m] = r_load_a[1];
    s_a[smem_sel_next][load_a_smem_k + 2][load_a_smem_m] = r_load_a[2];
    s_a[smem_sel_next][load_a_smem_k + 3][load_a_smem_m] = r_load_a[3];
    LDST128BITS(s_b[smem_sel_next][load_b_smem_k][load_b_smem_n]) = LDST128BITS(r_load_b[0]);

    __syncthreads();
  }
  
  // 计算剩下最后一块BK
  #pragma unroll
  for (int tk = 0; tk < BK; tk++) {
    LDST128BITS(r_comp_a[0]) = LDST128BITS(s_a[1][tk][ty * TM]);
    LDST128BITS(r_comp_b[0]) = LDST128BITS(s_b[1][tk][tx * TN]);

    #pragma unroll
    for (int tm = 0; tm < TM; tm++) {
      #pragma unroll
      for (int tn = 0; tn < TN; tn++) {
        r_c[tm][tn] = __hfma(r_comp_a[tm], r_comp_b[tn], r_c[tm][tn]);
      }
    }
  }

```


## 参考文献 

- [CUDA编程概念】一、什么是bank conflict？](https://zhuanlan.zhihu.com/p/659142274)
- [解决 bank conflict](https://github.com/PaddleJitLab/CUDATutorial/blob/develop/docs/09_optimize_reduce/02_bank_conflict/README.md)
- [Bank Conflict free 的几种方式](https://zhuanlan.zhihu.com/p/722286440)
- [Using Shared Memory in CUDA C/C++](https://developer.nvidia.com/blog/using-shared-memory-cuda-cc/)
- [CUDA（三）：通用矩阵乘法：从入门到熟练](https://zhuanlan.zhihu.com/p/657632577)

## 测试

```bash
# 只测试Ada架构 不指定默认编译所有架构 耗时较长: Volta, Ampere, Ada, Hopper, ...
export TORCH_CUDA_ARCH_LIST=Ada 
python3 hgemm.py
```

输出:

```bash
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=1024, K=256
                         out_f16: ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.162152ms
                     out_f16(sk): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.121955ms
          out_f16x4pack(t4x4bcf): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.021595ms
       out_f16x4pack(t4x4offset): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.021180ms
               out_f16x4(t8x8sk): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.028679ms
              out_f16x4(t8x8bcf): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.025246ms
           out_f16x4pack(t8x8sk): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.026116ms
              out_f16x4pack(bcf): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.023810ms
       out_f16x4pack(bcf+offset): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.023824ms
              out_f16x8pack(bcf): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.023782ms
       out_f16x8pack(bcf+offset): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.023645ms
             out_f16x8pack(dbuf): ['-23.90625   ', '29.125      ', '12.6484375  '], time:0.019011ms
                      out_f16_th: ['-23.828125  ', '29.046875   ', '12.6484375  '], time:0.010310ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=1024, K=512
                         out_f16: ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.319457ms
                     out_f16(sk): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.238678ms
          out_f16x4pack(t4x4bcf): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.041019ms
       out_f16x4pack(t4x4offset): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.040299ms
               out_f16x4(t8x8sk): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.052254ms
              out_f16x4(t8x8bcf): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.047995ms
           out_f16x4pack(t8x8sk): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.048609ms
              out_f16x4pack(bcf): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.045190ms
       out_f16x4pack(bcf+offset): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.044997ms
              out_f16x8pack(bcf): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.045103ms
       out_f16x8pack(bcf+offset): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.044857ms
             out_f16x8pack(dbuf): ['-8.890625   ', '-32.46875   ', '7.9375      '], time:0.035505ms
                      out_f16_th: ['-8.8515625  ', '-32.5       ', '7.9140625   '], time:0.016819ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=1024, K=1024
                         out_f16: ['53.28125    ', '27.75       ', '-18.296875  '], time:0.634142ms
                     out_f16(sk): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.471824ms
          out_f16x4pack(t4x4bcf): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.079725ms
       out_f16x4pack(t4x4offset): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.078288ms
               out_f16x4(t8x8sk): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.099672ms
              out_f16x4(t8x8bcf): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.093570ms
           out_f16x4pack(t8x8sk): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.093840ms
              out_f16x4pack(bcf): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.087830ms
       out_f16x4pack(bcf+offset): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.087477ms
              out_f16x8pack(bcf): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.087723ms
       out_f16x8pack(bcf+offset): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.087284ms
             out_f16x8pack(dbuf): ['53.28125    ', '27.75       ', '-18.296875  '], time:0.068520ms
                      out_f16_th: ['53.125      ', '27.421875   ', '-18.328125  '], time:0.029914ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=2048, K=256
                         out_f16: ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.309584ms
                     out_f16(sk): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.232592ms
          out_f16x4pack(t4x4bcf): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.037788ms
       out_f16x4pack(t4x4offset): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.037134ms
               out_f16x4(t8x8sk): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.045142ms
              out_f16x4(t8x8bcf): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.041173ms
           out_f16x4pack(t8x8sk): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.040542ms
              out_f16x4pack(bcf): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.038180ms
       out_f16x4pack(bcf+offset): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.038236ms
              out_f16x8pack(bcf): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.036573ms
       out_f16x8pack(bcf+offset): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.036463ms
             out_f16x8pack(dbuf): ['3.20507812  ', '15.2734375  ', '-8.65625    '], time:0.034016ms
                      out_f16_th: ['3.20507812  ', '15.2734375  ', '-8.6640625  '], time:0.018011ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=2048, K=512
                         out_f16: ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.611498ms
                     out_f16(sk): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.456554ms
          out_f16x4pack(t4x4bcf): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.073230ms
       out_f16x4pack(t4x4offset): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.071980ms
               out_f16x4(t8x8sk): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.084323ms
              out_f16x4(t8x8bcf): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.079292ms
           out_f16x4pack(t8x8sk): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.077398ms
              out_f16x4pack(bcf): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.073493ms
       out_f16x4pack(bcf+offset): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.073687ms
              out_f16x8pack(bcf): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.070355ms
       out_f16x8pack(bcf+offset): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.070046ms
             out_f16x8pack(dbuf): ['-15.375     ', '-8.1015625  ', '-7.7578125  '], time:0.065057ms
                      out_f16_th: ['-15.359375  ', '-8.2421875  ', '-7.828125   '], time:0.031242ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=2048, K=1024
                         out_f16: ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:1.215085ms
                     out_f16(sk): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.904187ms
          out_f16x4pack(t4x4bcf): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.145166ms
       out_f16x4pack(t4x4offset): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.142814ms
               out_f16x4(t8x8sk): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.162487ms
              out_f16x4(t8x8bcf): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.155417ms
           out_f16x4pack(t8x8sk): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.151247ms
              out_f16x4pack(bcf): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.143991ms
       out_f16x4pack(bcf+offset): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.144398ms
              out_f16x8pack(bcf): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.138216ms
       out_f16x8pack(bcf+offset): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.137445ms
             out_f16x8pack(dbuf): ['3.85742188  ', '-2.390625   ', '-16.46875   '], time:0.127822ms
                      out_f16_th: ['3.88867188  ', '-2.41992188 ', '-16.484375  '], time:0.057582ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=4096, K=256
                         out_f16: ['13.5234375  ', '29.640625   ', '26.5        '], time:0.606235ms
                     out_f16(sk): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.454569ms
          out_f16x4pack(t4x4bcf): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.070314ms
       out_f16x4pack(t4x4offset): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.068989ms
               out_f16x4(t8x8sk): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.065690ms
              out_f16x4(t8x8bcf): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.057906ms
           out_f16x4pack(t8x8sk): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.058073ms
              out_f16x4pack(bcf): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.053701ms
       out_f16x4pack(bcf+offset): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.053577ms
              out_f16x8pack(bcf): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.052278ms
       out_f16x8pack(bcf+offset): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.052042ms
             out_f16x8pack(dbuf): ['13.5234375  ', '29.640625   ', '26.5        '], time:0.049119ms
                      out_f16_th: ['13.5625     ', '29.609375   ', '26.546875   '], time:0.025352ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=4096, K=512
                         out_f16: ['16.515625   ', '0.93505859  ', '-17.1875    '], time:1.197983ms
                     out_f16(sk): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.893652ms
          out_f16x4pack(t4x4bcf): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.139344ms
       out_f16x4pack(t4x4offset): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.136861ms
               out_f16x4(t8x8sk): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.120757ms
              out_f16x4(t8x8bcf): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.111687ms
           out_f16x4pack(t8x8sk): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.110304ms
              out_f16x4pack(bcf): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.103440ms
       out_f16x4pack(bcf+offset): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.103147ms
              out_f16x8pack(bcf): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.100182ms
       out_f16x8pack(bcf+offset): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.099555ms
             out_f16x8pack(dbuf): ['16.515625   ', '0.93505859  ', '-17.1875    '], time:0.094203ms
                      out_f16_th: ['16.484375   ', '0.81054688  ', '-17.140625  '], time:0.044953ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=1024, N=4096, K=1024
                         out_f16: ['27.5625     ', '24.140625   ', '-13.1796875 '], time:2.382421ms
                     out_f16(sk): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:1.771888ms
          out_f16x4pack(t4x4bcf): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.277140ms
       out_f16x4pack(t4x4offset): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.273262ms
               out_f16x4(t8x8sk): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.230666ms
              out_f16x4(t8x8bcf): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.219387ms
           out_f16x4pack(t8x8sk): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.215188ms
              out_f16x4pack(bcf): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.202930ms
       out_f16x4pack(bcf+offset): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.202336ms
              out_f16x8pack(bcf): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.196809ms
       out_f16x8pack(bcf+offset): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.195358ms
             out_f16x8pack(dbuf): ['27.5625     ', '24.140625   ', '-13.1796875 '], time:0.184610ms
                      out_f16_th: ['27.78125    ', '24.15625    ', '-13.3359375 '], time:0.084101ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=1024, K=256
                         out_f16: ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.309631ms
                     out_f16(sk): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.232697ms
          out_f16x4pack(t4x4bcf): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.037850ms
       out_f16x4pack(t4x4offset): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.037194ms
               out_f16x4(t8x8sk): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.044630ms
              out_f16x4(t8x8bcf): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.041074ms
           out_f16x4pack(t8x8sk): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.040302ms
              out_f16x4pack(bcf): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.038220ms
       out_f16x4pack(bcf+offset): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.038198ms
              out_f16x8pack(bcf): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.036558ms
       out_f16x8pack(bcf+offset): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.036434ms
             out_f16x8pack(dbuf): ['31.53125    ', '9.625       ', '-2.05859375 '], time:0.034007ms
                      out_f16_th: ['31.515625   ', '9.65625     ', '-2.06445312 '], time:0.017991ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=1024, K=512
                         out_f16: ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.611916ms
                     out_f16(sk): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.456705ms
          out_f16x4pack(t4x4bcf): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.073276ms
       out_f16x4pack(t4x4offset): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.071982ms
               out_f16x4(t8x8sk): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.083909ms
              out_f16x4(t8x8bcf): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.079222ms
           out_f16x4pack(t8x8sk): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.077219ms
              out_f16x4pack(bcf): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.073688ms
       out_f16x4pack(bcf+offset): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.073673ms
              out_f16x8pack(bcf): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.070326ms
       out_f16x8pack(bcf+offset): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.070006ms
             out_f16x8pack(dbuf): ['-8.390625   ', '38.5625     ', '2.90234375  '], time:0.065054ms
                      out_f16_th: ['-8.4140625  ', '38.40625    ', '2.91601562  '], time:0.031183ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=1024, K=1024
                         out_f16: ['7.14453125  ', '-34.46875   ', '33.28125    '], time:1.215496ms
                     out_f16(sk): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.904354ms
          out_f16x4pack(t4x4bcf): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.145215ms
       out_f16x4pack(t4x4offset): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.142813ms
               out_f16x4(t8x8sk): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.162309ms
              out_f16x4(t8x8bcf): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.155714ms
           out_f16x4pack(t8x8sk): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.150831ms
              out_f16x4pack(bcf): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.144459ms
       out_f16x4pack(bcf+offset): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.144314ms
              out_f16x8pack(bcf): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.137980ms
       out_f16x8pack(bcf+offset): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.137455ms
             out_f16x8pack(dbuf): ['7.14453125  ', '-34.46875   ', '33.28125    '], time:0.127817ms
                      out_f16_th: ['6.9609375   ', '-34.15625   ', '33.5        '], time:0.057532ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=2048, K=256
                         out_f16: ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.606350ms
                     out_f16(sk): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.455183ms
          out_f16x4pack(t4x4bcf): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.070434ms
       out_f16x4pack(t4x4offset): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.069097ms
               out_f16x4(t8x8sk): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.067122ms
              out_f16x4(t8x8bcf): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.057893ms
           out_f16x4pack(t8x8sk): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.058693ms
              out_f16x4pack(bcf): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.053744ms
       out_f16x4pack(bcf+offset): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.053674ms
              out_f16x8pack(bcf): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.052449ms
       out_f16x8pack(bcf+offset): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.052198ms
             out_f16x8pack(dbuf): ['1.84375     ', '-8.0234375  ', '-5.62890625 '], time:0.049208ms
                      out_f16_th: ['1.82617188  ', '-8.015625   ', '-5.65234375 '], time:0.025376ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=2048, K=512
                         out_f16: ['28.15625    ', '43.09375    ', '-8.765625   '], time:1.198318ms
                     out_f16(sk): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.894948ms
          out_f16x4pack(t4x4bcf): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.139518ms
       out_f16x4pack(t4x4offset): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.136982ms
               out_f16x4(t8x8sk): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.122198ms
              out_f16x4(t8x8bcf): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.111648ms
           out_f16x4pack(t8x8sk): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.111161ms
              out_f16x4pack(bcf): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.103313ms
       out_f16x4pack(bcf+offset): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.103238ms
              out_f16x8pack(bcf): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.100296ms
       out_f16x8pack(bcf+offset): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.099789ms
             out_f16x8pack(dbuf): ['28.15625    ', '43.09375    ', '-8.765625   '], time:0.094228ms
                      out_f16_th: ['28.328125   ', '43.1875     ', '-8.7734375  '], time:0.044975ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=2048, K=1024
                         out_f16: ['31.953125   ', '-24.375     ', '1.33691406  '], time:2.382188ms
                     out_f16(sk): ['31.953125   ', '-24.375     ', '1.33691406  '], time:1.773512ms
          out_f16x4pack(t4x4bcf): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.277877ms
       out_f16x4pack(t4x4offset): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.273361ms
               out_f16x4(t8x8sk): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.233111ms
              out_f16x4(t8x8bcf): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.220381ms
           out_f16x4pack(t8x8sk): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.216933ms
              out_f16x4pack(bcf): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.203425ms
       out_f16x4pack(bcf+offset): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.202874ms
              out_f16x8pack(bcf): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.197368ms
       out_f16x8pack(bcf+offset): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.196184ms
             out_f16x8pack(dbuf): ['31.953125   ', '-24.375     ', '1.33691406  '], time:0.185119ms
                      out_f16_th: ['32.03125    ', '-24.46875   ', '1.41210938  '], time:0.084420ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=4096, K=256
                         out_f16: ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:1.205165ms
                     out_f16(sk): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.903791ms
          out_f16x4pack(t4x4bcf): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.131277ms
       out_f16x4pack(t4x4offset): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.128841ms
               out_f16x4(t8x8sk): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.124274ms
              out_f16x4(t8x8bcf): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.108666ms
           out_f16x4pack(t8x8sk): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.108618ms
              out_f16x4pack(bcf): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.100218ms
       out_f16x4pack(bcf+offset): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.099845ms
              out_f16x8pack(bcf): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.097036ms
       out_f16x8pack(bcf+offset): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.096186ms
             out_f16x8pack(dbuf): ['23.046875   ', '6.28515625  ', '-0.76660156 '], time:0.093224ms
                      out_f16_th: ['23.03125    ', '6.2890625   ', '-0.78417969 '], time:0.046790ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=4096, K=512
                         out_f16: ['21.1875     ', '16.765625   ', '-17.984375  '], time:2.384285ms
                     out_f16(sk): ['21.1875     ', '16.765625   ', '-17.984375  '], time:1.776543ms
          out_f16x4pack(t4x4bcf): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.260412ms
       out_f16x4pack(t4x4offset): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.256168ms
               out_f16x4(t8x8sk): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.231487ms
              out_f16x4(t8x8bcf): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.211654ms
           out_f16x4pack(t8x8sk): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.208195ms
              out_f16x4pack(bcf): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.195177ms
       out_f16x4pack(bcf+offset): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.194470ms
              out_f16x8pack(bcf): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.188873ms
       out_f16x8pack(bcf+offset): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.187346ms
             out_f16x8pack(dbuf): ['21.1875     ', '16.765625   ', '-17.984375  '], time:0.181744ms
                      out_f16_th: ['21.1875     ', '16.703125   ', '-17.96875   '], time:0.090159ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=2048, N=4096, K=1024
                         out_f16: ['25.28125    ', '-35.8125    ', '-34.90625   '], time:4.740940ms
                     out_f16(sk): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:3.523728ms
          out_f16x4pack(t4x4bcf): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.526218ms
       out_f16x4pack(t4x4offset): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.514424ms
               out_f16x4(t8x8sk): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.444150ms
              out_f16x4(t8x8bcf): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.418200ms
           out_f16x4pack(t8x8sk): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.407552ms
              out_f16x4pack(bcf): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.384386ms
       out_f16x4pack(bcf+offset): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.383409ms
              out_f16x8pack(bcf): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.372210ms
       out_f16x8pack(bcf+offset): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.370581ms
             out_f16x8pack(dbuf): ['25.28125    ', '-35.8125    ', '-34.90625   '], time:0.359300ms
                      out_f16_th: ['25.21875    ', '-36.03125   ', '-34.84375   '], time:0.168989ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=1024, K=256
                         out_f16: ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.606902ms
                     out_f16(sk): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.456121ms
          out_f16x4pack(t4x4bcf): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.070778ms
       out_f16x4pack(t4x4offset): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.069436ms
               out_f16x4(t8x8sk): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.065789ms
              out_f16x4(t8x8bcf): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.058092ms
           out_f16x4pack(t8x8sk): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.058286ms
              out_f16x4pack(bcf): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.053996ms
       out_f16x4pack(bcf+offset): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.053891ms
              out_f16x8pack(bcf): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.052655ms
       out_f16x8pack(bcf+offset): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.052357ms
             out_f16x8pack(dbuf): ['5.2265625   ', '-14.3046875 ', '12.6953125  '], time:0.049304ms
                      out_f16_th: ['5.20703125  ', '-14.28125   ', '12.625      '], time:0.025346ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=1024, K=512
                         out_f16: ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:1.199327ms
                     out_f16(sk): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.895021ms
          out_f16x4pack(t4x4bcf): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.139593ms
       out_f16x4pack(t4x4offset): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.137124ms
               out_f16x4(t8x8sk): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.120680ms
              out_f16x4(t8x8bcf): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.111681ms
           out_f16x4pack(t8x8sk): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.110540ms
              out_f16x4pack(bcf): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.103607ms
       out_f16x4pack(bcf+offset): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.103339ms
              out_f16x8pack(bcf): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.100309ms
       out_f16x8pack(bcf+offset): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.099732ms
             out_f16x8pack(dbuf): ['6.765625    ', '-1.97167969 ', '-23.640625  '], time:0.094197ms
                      out_f16_th: ['6.71875     ', '-1.98535156 ', '-23.703125  '], time:0.044829ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=1024, K=1024
                         out_f16: ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:2.383269ms
                     out_f16(sk): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:1.773585ms
          out_f16x4pack(t4x4bcf): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.277344ms
       out_f16x4pack(t4x4offset): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.273213ms
               out_f16x4(t8x8sk): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.231479ms
              out_f16x4(t8x8bcf): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.219741ms
           out_f16x4pack(t8x8sk): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.215539ms
              out_f16x4pack(bcf): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.202891ms
       out_f16x4pack(bcf+offset): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.203077ms
              out_f16x8pack(bcf): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.197309ms
       out_f16x8pack(bcf+offset): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.196089ms
             out_f16x8pack(dbuf): ['-18.734375  ', '23.484375   ', '-15.2890625 '], time:0.185151ms
                      out_f16_th: ['-18.640625  ', '23.484375   ', '-15.1875    '], time:0.084677ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=2048, K=256
                         out_f16: ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:1.207559ms
                     out_f16(sk): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.904191ms
          out_f16x4pack(t4x4bcf): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.131142ms
       out_f16x4pack(t4x4offset): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.128715ms
               out_f16x4(t8x8sk): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.128132ms
              out_f16x4(t8x8bcf): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.108476ms
           out_f16x4pack(t8x8sk): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.109819ms
              out_f16x4pack(bcf): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.099860ms
       out_f16x4pack(bcf+offset): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.099651ms
              out_f16x8pack(bcf): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.097065ms
       out_f16x8pack(bcf+offset): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.096196ms
             out_f16x8pack(dbuf): ['0.18762207  ', '-16.328125  ', '-9.28125    '], time:0.093154ms
                      out_f16_th: ['0.20019531  ', '-16.359375  ', '-9.28125    '], time:0.046717ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=2048, K=512
                         out_f16: ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:2.384526ms
                     out_f16(sk): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:1.778904ms
          out_f16x4pack(t4x4bcf): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.259862ms
       out_f16x4pack(t4x4offset): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.256946ms
               out_f16x4(t8x8sk): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.235498ms
              out_f16x4(t8x8bcf): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.211723ms
           out_f16x4pack(t8x8sk): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.209528ms
              out_f16x4pack(bcf): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.194957ms
       out_f16x4pack(bcf+offset): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.194530ms
              out_f16x8pack(bcf): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.189021ms
       out_f16x8pack(bcf+offset): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.187663ms
             out_f16x8pack(dbuf): ['-0.86279297 ', '-0.78173828 ', '-26.921875  '], time:0.181922ms
                      out_f16_th: ['-0.86572266 ', '-0.75537109 ', '-26.90625   '], time:0.085870ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=2048, K=1024
                         out_f16: ['-30.9375    ', '22.625      ', '-8.75       '], time:4.738972ms
                     out_f16(sk): ['-30.9375    ', '22.625      ', '-8.75       '], time:3.529367ms
          out_f16x4pack(t4x4bcf): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.526890ms
       out_f16x4pack(t4x4offset): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.515642ms
               out_f16x4(t8x8sk): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.448207ms
              out_f16x4(t8x8bcf): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.418634ms
           out_f16x4pack(t8x8sk): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.409610ms
              out_f16x4pack(bcf): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.385201ms
       out_f16x4pack(bcf+offset): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.384448ms
              out_f16x8pack(bcf): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.373107ms
       out_f16x8pack(bcf+offset): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.372995ms
             out_f16x8pack(dbuf): ['-30.9375    ', '22.625      ', '-8.75       '], time:0.359854ms
                      out_f16_th: ['-30.953125  ', '22.734375   ', '-8.7578125  '], time:0.169054ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=4096, K=256
                         out_f16: ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:2.403322ms
                     out_f16(sk): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:1.799120ms
          out_f16x4pack(t4x4bcf): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.252224ms
       out_f16x4pack(t4x4offset): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.250270ms
               out_f16x4(t8x8sk): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.230155ms
              out_f16x4(t8x8bcf): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.208173ms
           out_f16x4pack(t8x8sk): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.206509ms
              out_f16x4pack(bcf): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.191518ms
       out_f16x4pack(bcf+offset): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.190922ms
              out_f16x8pack(bcf): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.184900ms
       out_f16x8pack(bcf+offset): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.183368ms
             out_f16x8pack(dbuf): ['13.765625   ', '-1.97753906 ', '-14.953125  '], time:0.180867ms
                      out_f16_th: ['13.7421875  ', '-1.984375   ', '-14.9609375 '], time:0.088463ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=4096, K=512
                         out_f16: ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:4.749713ms
                     out_f16(sk): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:3.543025ms
          out_f16x4pack(t4x4bcf): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.508850ms
       out_f16x4pack(t4x4offset): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.505403ms
               out_f16x4(t8x8sk): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.441533ms
              out_f16x4(t8x8bcf): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.410424ms
           out_f16x4pack(t8x8sk): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.403210ms
              out_f16x4pack(bcf): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.376480ms
       out_f16x4pack(bcf+offset): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.376418ms
              out_f16x8pack(bcf): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.365713ms
       out_f16x8pack(bcf+offset): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.362226ms
             out_f16x8pack(dbuf): ['13.6796875  ', '-39.34375   ', '4.8046875   '], time:0.356183ms
                      out_f16_th: ['13.6953125  ', '-39.4375    ', '4.7734375   '], time:0.168072ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             M=4096, N=4096, K=1024
                         out_f16: ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:9.449276ms
                     out_f16(sk): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:7.027740ms
          out_f16x4pack(t4x4bcf): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:1.033735ms
       out_f16x4pack(t4x4offset): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:1.020987ms
               out_f16x4(t8x8sk): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:0.857793ms
              out_f16x4(t8x8bcf): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:0.814633ms
           out_f16x4pack(t8x8sk): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:0.796247ms
              out_f16x4pack(bcf): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:0.754777ms
       out_f16x4pack(bcf+offset): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:0.754538ms
              out_f16x8pack(bcf): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:0.731132ms
       out_f16x8pack(bcf+offset): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:0.729123ms
             out_f16x8pack(dbuf): ['-74.6875    ', '-5.484375   ', '1.04882812  '], time:0.720609ms
                      out_f16_th: ['-74.375     ', '-5.49609375 ', '1.1015625   '], time:0.334342ms
--------------------------------------------------------------------------------------------------------------
```
